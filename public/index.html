<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>SCOUT ë©€í‹°</title>
<link rel="stylesheet" href="style.css" />
</head>

<body>

<!-- =================================================== -->
<!-- START PAGE -->
<!-- =================================================== -->
<div id="startPage" class="page visible">
  <div class="board-panel panel-center">
    <h1 class="game-title">ğŸ´ SCOUT ğŸ´</h1>
    <input id="nicknameInput" class="input-box" placeholder="ë‹‰ë„¤ì„ ì…ë ¥" />

    <button id="makeRoomBtn" class="btn-main">ë°© ë§Œë“¤ê¸°</button>
    <button id="enterRoomBtn" class="btn-sub">ì´ˆëŒ€ ë§í¬ë¡œ ì…ì¥</button>
  </div>
</div>

<!-- =================================================== -->
<!-- ROOM PAGE -->
<!-- =================================================== -->
<div id="roomPage" class="page">
  <div class="board-panel wide">
    <h2 id="roomTitle" class="title-board"></h2>

    <div id="playerList" class="player-list-board"></div>

    <div class="room-bottom-row">
      <button id="readyBtn" class="btn-main">ê²Œì„ ì¤€ë¹„</button>
      <button id="startGameBtn" class="btn-green" style="display:none;">ê²Œì„ ì‹œì‘</button>
      <button id="copyInviteBtn" class="btn-sub">ì´ˆëŒ€ ë§í¬ ë³µì‚¬</button>
    </div>
  </div>
</div>

<!-- =================================================== -->
<!-- GAME PAGE -->
<!-- =================================================== -->
<div id="gamePage" class="page">

  <h2 id="roundInfo" class="title-board"></h2>

  <div class="game-layout">

    <!-- ì¢Œì¸¡ í”Œë ˆì´ì–´ ë¦¬ìŠ¤íŠ¸ -->
    <div id="gamePlayerList" class="sideBoard"></div>

    <!-- ë©”ì¸ ê²Œì„ ë³´ë“œ -->
    <div class="mainBoard">

      <!-- í…Œì´ë¸” -->
      <h3 class="section-title">í…Œì´ë¸”</h3>
      <div id="tableArea" class="tableBoard"></div>

      <!-- íŒ¨ ë°©í–¥ ì„ íƒ UI -->
      <div id="flipSelectArea" class="flip-area hidden">
        <h3 class="section-title">íŒ¨ ë°©í–¥ ì„ íƒ</h3>

        <button id="flipToggleBtn" class="btn-main">â†º ë°©í–¥ ë°”ê¾¸ê¸°</button>
        <br /><br />

        <button id="flipConfirmBtn" class="btn-green">
          âœ” ë°©í–¥ í™•ì •
        </button>
      </div>

      <!-- ë‚´ íŒ¨ -->
      <h3 class="section-title">
        ë‚´ íŒ¨ (<span id="myCount">0</span>)
      </h3>
      <div id="handArea" class="handBoard"></div>

      <!-- í•˜ë‹¨ í–‰ë™ ë²„íŠ¼ -->
      <div class="action-row">
        <button id="showBtn" class="btn-main large">SHOW</button>
        <button id="scoutBtn" class="btn-orange large">SCOUT</button>
        <button id="showScoutBtn" class="btn-purple large">SHOW & SCOUT</button>
      </div>

    </div>
  </div>
</div>

<!-- =================================================== -->
<!-- INSERT OVERLAY (B ë°©ì‹) -->
<!-- =================================================== -->
<div id="insertOverlay" class="insert-overlay hidden">
  <div class="insert-box">
    <h2 style="margin-top:0;">ì‚½ì… ìœ„ì¹˜ ì„ íƒ</h2>
    <div id="insertSlots" class="insertSlots"></div>

    <button class="btn-sub" onclick="document.getElementById('insertOverlay').classList.add('hidden')">
      ë‹«ê¸°
    </button>
  </div>
</div>

<!-- =================================================== -->
<!-- SCRIPTS -->
<!-- =================================================== -->
<script src="/socket.io/socket.io.js"></script>
<script type="module" src="./socket.js"></script>
<script type="module" src="./roomUI.js"></script>
<script type="module" src="./gameUI.js"></script>

<!-- ì´ˆëŒ€ ìë™ì…ì¥ -->
<script>
window.addEventListener("DOMContentLoaded", () => {
  const params = new URLSearchParams(location.search);
  const invitedRoom = params.get("room");

  if (invitedRoom) {
    const nickname = prompt("ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”:");
    if (!nickname) return;

    window.roomId = invitedRoom;
    window.myName = nickname;

    window.socket.emit("joinRoom", {
      roomId,
      nickname: myName,
      permUid: localStorage.getItem("scout_uid")
    });

    roomTitle.innerText = `ë°©ë²ˆí˜¸: ${roomId}`;
    window.showPage("roomPage");
  }
});
</script>

</body>
</html>
